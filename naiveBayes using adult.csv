library(caTools)
library(caret)
library(e1071)
data=read.csv("/Users/shanmathishenbaganathan/Documents/adult.csv")
head(data)
set.seed(123)
split=sample.split(data,SplitRatio=0.7)
train_cl=subset(data,split=="TRUE")
test_cl=subset(data,split=="FALSE")
numerical_cols=c("age", "fnlwgt", "education_num", "capitalGain", "capitalLoss", "hoursPerWeek")
train_scale=scale(train_cl[,numerical_cols])
test_scale=scale(test_cl[,numerical_cols])
head(train_scale)
head(test_scale)
classifier_cl=naiveBayes(age~.,data=train_cl)
classifier_cl
y_pred=predict(classifier_cl,newdata=test_cl)
cm=table(y_pred,test_cl$age)
cm
