install.packages("dplyr")
library(dplyr)
summary(iris)
install.packages("caTools")
install.packages("ROCR")
library(caTools)
library(ROCR)
iris
head(iris)
split=sample.split(iris,SplitRatio=0.8)
split
iris$Sepal.Length=ifelse(iris$Sepal.Length>5,1,0)
train_reg=subset(iris,split==TRUE)
test_reg=subset(iris,split==FALSE)
logistic_model=glm(iris$Sepal.Length~iris$Sepal.Width,data=train_reg,family="binomial")
logistic_model
summary(logistic_model)
predict_reg=predict(logistic_model,test_reg,type="response")
predict_reg
predict_reg=ifelse(predict_reg>0.5,1,0)
table(test_reg$Sepal.Length,predict_reg)
missing_classerr=mean(predict_reg!=test_reg$Sepal.Length)
print(paste("Accuracy=",1-missing_classerr))
ROCPred=prediction(predict_reg,test_reg$Sepal.Length)
ROCPer=performance(ROCPred,measure="tpr",x.measure="fpr")
auc=performance(ROCPred,measure="auc")
auc=auc@y.values[[1]]
auc
plot(ROCPer)
plot(ROCPer,coloursize=TRUE,print.cutoff.at=seq(0.1,by=0.1),main="ROC curve")
abline(a=0,b=1)
auc=round(auc,4)
legend(.6,.4,auc,title="auc",cex=1)
