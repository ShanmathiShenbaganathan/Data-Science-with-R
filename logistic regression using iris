library(dplyr)
summary(iris)
library(caTools)
library(ROCR)
data(iris)
head(iris)
iris$Sepal.Length=ifelse(iris$Sepal.Length>5,1,0)
set.seed(123)
split=sample.split(iris,SplitRatio=0.8)
split
train_reg=subset(iris,split==TRUE)
test_reg=subset(iris,split==FALSE)
logistic_model=glm(Sepal.Length~Sepal.Width,data=train_reg,family="binomial")
logistic_model
summary(logistic_model)
predict_reg=predict(logistic_model,test_reg,type="response")
predict_reg
predict_reg=ifelse(predict_reg>0.5,1,0)
table(test_reg$Sepal.Length,predict_reg)
confusion_matrix=table(test_reg$Sepal.Length,predict_reg)
print(confusion_matrix)
missing_classerr=mean(predict_reg!=test_reg$Sepal.Length)
accuracy=1-missing_classerr
print(paste("Accuracy=",accuracy))
ROCPred=prediction(predict_reg,test_reg$Sepal.Length)
ROCPer=performance(ROCPred,measure="tpr",x.measure="fpr")
auc=performance(ROCPred,measure="auc")
auc_value=auc@y.values[[1]]
auc
plot(ROCPer)
plot(ROCPer,colour="blue",main="ROC curve")
abline(a=0,b=1,lty=2,col="red")
legend("bottomright",legend=paste("AUC=",round(auc_value,4)),col="blue",lwd=2)
print(paste("AUC=",round(auc_value,4)))
